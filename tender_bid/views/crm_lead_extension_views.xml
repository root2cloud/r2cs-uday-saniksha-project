<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="view_crm_lead_form_inherit_tender" model="ir.ui.view">
        <field name="name">crm.lead.form.inherit.tender</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']" position="inside">
                <button name="open_tender_bids"
                        type="object"
                        class="oe_stat_button btn btn-primary btn-sm"
                        icon="fa-folder-open"
                        style="margin-right:4px;">
                    <field name="tender_bid_count" widget="statinfo" string="Tender Bids"/>
                </button>

                <button name="open_boq_lines"
                        type="object"
                        class="oe_stat_button btn btn-primary btn-sm"
                        icon="fa-list">
                    <field name="boq_line_count" widget="statinfo" string="BOQ Lines"/>
                </button>
            </xpath>
            <xpath expr="//notebook" position="before">
                <group string="Tender Information" colspan="2">
                    <field name="currency_id" options="{'no_create': True}"/>
                    <field name="tender_no"/>
                    <field name="emd_amount"/>
                    <field name="bg_amount"/>
                    <field name="submission_date"/>
                </group>
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page string="Tender Bids">
                    <field name="tender_bid_ids">
                        <list editable="bottom">
                            <field name="tender_no"/>
                            <field name="project_type"/>
                            <field name="submission_date"/>
                            <field name="status"/>
                            <field name="estimated_value"/>
                        </list>
                    </field>
                </page>
            </xpath>
        </field>
    </record>


    <record id="crm_lead_form_view_boq_inherit" model="ir.ui.view">
        <field name="name">crm.lead.form.boq.notebook.inherit</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <!-- Add your BOQ page just before the Internal Notes tab -->
            <xpath expr="//page[@name='internal_notes']" position="before">
                <page string="BOQ" name="boq">
                    <field name="boq_line_ids">
                        <list editable="bottom">
                            <field name="item_code"/>
                            <field name="description"/>
                            <field name="quantity"/>
                            <field name="unit"/>
                            <field name="rate"/>
                            <field name="amount"/>
                        </list>
                    </field>
                </page>
                <page string="Survey Information" name="survey_information">
                    <group>
                        <group>
                            <field name="survey_date"/>
                            <field name="survey_team_ids" widget="many2many_tags" options="{'no_create': True}"/>
                            <field name="survey_location"/>
                            <field name="area_sqm"/>
                            <field name="reference_drawing_ids" widget="many2many_binary"/>
                            <field name="nearby_facilities"/>
                            <field name="survey_approval_status"/>
                        </group>
                        <group>
                            <field name="site_accessibility"/>
                            <field name="existing_infrastructure"/>
                            <field name="utilities_availability"/>
                            <field name="utilities_remarks"/>
                            <field name="topographical_details"/>
                            <field name="soil_details"/>
                            <field name="soil_contaminated"/>
                            <field name="weather_notes"/>
                            <field name="weather_risk"/>

                        </group>
                        <group>
                            <field name="risk_score" readonly="1"/>

                            <field name="access_constraints"/>
                            <field name="key_observations"/>
                            <field name="safety_concerns"/>
                            <field name="risk_assessment"/>
                        </group>
                    </group>
                </page>

            </xpath>
        </field>
    </record>

    <record id="crm_lead_view_inherit_tender_documents" model="ir.ui.view">
        <field name="name">crm.lead.form.inherit.tender.documents</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Tender Documents" name="tender_documents">
                    <field name="tender_document_ids"
                           context="{'default_lead_id': id, 'default_partner_id': partner_id}">
                        <list editable="bottom" create="true" delete="true">
                            <field name="name"/>
                            <field name="document_type"/>
                            <field name="upload_date"/>
                        </list>
                        <form string="Tender Document">
                            <sheet>
                                <group>
                                    <field name="name"/>
                                    <field name="document_type"/>
                                    <field name="attachment" filename="attachment_filename"/>
                                    <field name="attachment_filename"/>
                                    <field name="upload_date" readonly="1"/>
                                </group>
                            </sheet>
                        </form>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

</odoo>

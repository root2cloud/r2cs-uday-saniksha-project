<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Form View -->
    <record id="view_tender_bid_form" model="ir.ui.view">
        <field name="name">tender.bid.form</field>
        <field name="model">tender.bid</field>
        <field name="arch" type="xml">
            <form string="Tender Bid">
                <header>
                    <button name="action_mark_won" string="Mark Won" type="object" class="btn-success"/>
                    <button name="action_mark_lost" string="Mark Lost" type="object" class="btn-danger"/>
                    <button string="Close" class="btn-secondary" special="cancel"/>
                    <field name="status" widget="statusbar" options="{'clickable': True}"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="tender_no"/>
                        </h1>
                    </div>
                    <group col="2">
                        <group>
                            <field name="tender_ref" options="{'no_create': True}"/>
                            <field name="project_type"/>
                            <field name="emd_amount"/>
                            <field name="bg_amount"/>
                            <field name="submission_date"/>
                        </group>
                        <group>
                            <field name="estimated_value"/>
                            <field name="probability"/>
                            <field name="close_reason"/>
                            <field name="close_reason_note"/>
                        </group>
                    </group>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- Tree/List View -->
    <record id="view_tender_bid_tree" model="ir.ui.view">
        <field name="name">tender.bid.tree</field>
        <field name="model">tender.bid</field>
        <field name="arch" type="xml">
            <list string="Tender Bids">
                <field name="tender_no"/>
                <field name="tender_ref"/>
                <field name="project_type"/>
                <field name="submission_date"/>
                <field name="status"/>
                <field name="estimated_value"/>
            </list>
        </field>
    </record>

    <!-- Kanban View -->
    <record id="view_tender_bid_kanban" model="ir.ui.view">
        <field name="name">tender.bid.kanban</field>
        <field name="model">tender.bid</field>
        <field name="arch" type="xml">
            <kanban default_group_by="stage_id">
                <field name="stage_id"/>
                <field name="status"/>
                <field name="tender_no"/>
                <field name="project_type"/>
                <field name="submission_date"/>
                <field name="estimated_value"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click"
                             style="padding:16px 20px 14px 20px; margin:8px 0; border-radius:9px; background:#fff; box-shadow:0 1px 4px rgba(0,0,0,0.05);">
                            <!-- Status Ribbon -->
                            <div t-if="record.status.raw_value == 'draft'"
                                 style="background:#b4b4b4; color:#fff; padding:4px 12px; border-radius:5px 5px 0 0; font-size:13px; font-weight:bold; margin-bottom:10px;">
                                Draft
                            </div>
                            <div t-if="record.status.raw_value == 'in_process'"
                                 style="background:#1fa2ff; color:#fff; padding:4px 12px; border-radius:5px 5px 0 0; font-size:13px; font-weight:bold; margin-bottom:10px;">
                                In Process
                            </div>
                            <div t-if="record.status.raw_value == 'submitted'"
                                 style="background:#007bff; color:#fff; padding:4px 12px; border-radius:5px 5px 0 0; font-size:13px; font-weight:bold; margin-bottom:10px;">
                                Submitted
                            </div>
                            <div t-if="record.status.raw_value == 'won'"
                                 style="background:#22c55e; color:#fff; padding:4px 12px; border-radius:5px 5px 0 0; font-size:13px; font-weight:bold; margin-bottom:10px;">
                                Won
                            </div>
                            <div t-if="record.status.raw_value == 'lost'"
                                 style="background:#ef4444; color:#fff; padding:4px 12px; border-radius:5px 5px 0 0; font-size:13px; font-weight:bold; margin-bottom:10px;">
                                Lost
                            </div>

                            <!-- Bid Number -->
                            <div style="font-size:18px; font-weight:600; letter-spacing:.5px; margin-bottom:8px;">
                                <t t-esc="record.tender_no and record.tender_no.value or ''"/>
                            </div>
                            <!-- Project Type/Status row -->
                            <div style="margin-bottom:12px;">
                                <span style="font-size:13px;font-weight:bold;">Type:</span>
                                <span style="margin-left:2px;">
                                    <t t-esc="record.project_type and record.project_type.value or ''"/>
                                </span>
                            </div>
                            <!-- Submission Date & Value row -->
                            <div style="margin-bottom:10px;">
                                <span style="font-size:13px;font-weight:bold;color:#555;">
                                    <i class="fa fa-calendar" style="color:#6c757d;margin-right:3px;"/>
                                    Date:
                                </span>
                                <span style="margin-left:2px;">
                                    <t t-esc="record.submission_date and record.submission_date.value or '-'"/>
                                </span>
                            </div>
                            <div style="margin-bottom:3px;">
                                <span style="font-size:13px;font-weight:bold;">Value:</span>
                                <span style="margin-left:2px;">
                                    <t t-esc="record.estimated_value and record.estimated_value.value or '0.00'"/>
                                </span>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Calendar View -->
    <record id="view_tender_bid_calendar" model="ir.ui.view">
        <field name="name">tender.bid.calendar</field>
        <field name="model">tender.bid</field>
        <field name="arch" type="xml">
            <calendar string="Tender Bids" date_start="submission_date" color="status"/>
        </field>
    </record>

    <!-- Pivot View -->
    <record id="view_tender_bid_pivot" model="ir.ui.view">
        <field name="name">tender.bid.pivot</field>
        <field name="model">tender.bid</field>
        <field name="arch" type="xml">
            <pivot string="Tender Bids Analysis">
                <field name="estimated_value" type="measure"/>
                <field name="probability" type="measure"/>
                <field name="status" type="row"/>
                <field name="project_type" type="col"/>
            </pivot>
        </field>
    </record>

    <record id="view_tender_bid_search" model="ir.ui.view">
        <field name="name">tender.bid.search</field>
        <field name="model">tender.bid</field>
        <field name="arch" type="xml">
            <search string="Tender Bid Search">
                <field name="tender_no"/>
                <field name="tender_ref" string="Tender Reference"/>
                <field name="project_type"/>
                <field name="status"/>
                <field name="submission_date"/>
                <field name="estimated_value" filter_domain="[('estimated_value','>=',self)]"/>
                <filter name="won" string="Won" domain="[('status','=','won')]"/>
                <filter name="lost" string="Lost" domain="[('status','=','lost')]"/>
                <filter name="in_process" string="In Process" domain="[('status','=','in_process')]"/>
            </search>
        </field>
    </record>

    <!-- Actions -->
    <record id="action_tender_bid" model="ir.actions.act_window">
        <field name="name">Tender Bids</field>
        <field name="res_model">tender.bid</field>
        <field name="view_mode">kanban,list,form,calendar,pivot</field>
        <field name="search_view_id" ref="view_tender_bid_search"/>
    </record>


    <!-- Menu Items -->
    <menuitem id="menu_tender_bid_root" name="Tender Bids" parent="crm.crm_menu_root" sequence="10"/>
    <menuitem id="menu_tender_bid" name="Tender Bids" parent="menu_tender_bid_root" action="action_tender_bid"/>
</odoo>
